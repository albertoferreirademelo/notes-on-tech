---
import '../styles/theme.css';

const {
  title = 'Alberto Ferreira de Melo',
  description = 'Thoughts, experiments, and notes on technology and life.',
  plausibleDomain = '',
} = Astro.props;

const base = import.meta.env.BASE_URL || '/';
const normalizeBase = base === '/' ? '' : base.replace(/\/$/, '');
const withBase = (path: string) => {
  if (!path.startsWith('/')) return path;
  return `${normalizeBase}${path}`;
};

const navLinks = [
  { href: '/', label: 'Start' },
  { href: '/notes', label: 'Notes' },
  { href: '/projects', label: 'Projects' },
  { href: '/about', label: 'About' },
  { href: '/rss.xml', label: 'RSS' },
];
---
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{title}</title>
    <meta name="description" content={description} />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Playfair+Display:wght@500;600&display=swap"
      rel="stylesheet"
    />
    {plausibleDomain && (
      <script
        is:inline
        defer
        data-domain={plausibleDomain}
        src="https://plausible.io/js/script.js"
      ></script>
    )}
  </head>
  <body>
    <div class="site-shell">
      <header class="site-header">
        <p class="site-note">Personal site. Opinions and drafts — not my employer.</p>
        <a class="site-title" href={withBase('/')}>Alberto Ferreira de Melo</a>
        <p class="site-subtitle">Thoughts, experiments, and notes on technology and life.</p>
        <nav class="site-nav" aria-label="Site navigation">
          <ul>
            {navLinks.map((link) => (
              <li>
                <a href={withBase(link.href)}>{link.label}</a>
              </li>
            ))}
          </ul>
        </nav>
      </header>
      <main class="site-main">
        <slot />
      </main>
      <footer class="site-footer">
        <p>© {new Date().getFullYear()} Alberto Ferreira de Melo — always a work in progress.</p>
      </footer>
    </div>
  </body>
</html>

